<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ecodom</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' https://cdn.socket.io https://cdn.jsdelivr.net">
    <script src="/socket.io.min.js"></script>
    <!-- <script src="https://cdn.socket.io/4.7.0/socket.io.min.js"></script> -->
    <meta name="description" content="EcoDom - система умного дома на Raspberry Pi. Управление температурой, безопасностью, видеонаблюдением и энергопотреблением через веб-интерфейс.">
    <meta property="og:description" content="Интеллектуальная система управления домом">
    <meta property="og:image" content="https://ecodom.asia/og-image.jpg">

    <meta name="keywords" content="умный дом, ecodom, raspberry pi, безопасность дома, видеонаблюдение">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!-- Для соц.сетей (index.html) -->
    <meta property="og:title" content="EcoDom - Умный дом">
    <meta name="twitter:card" content="summary_large_image">
    
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="EcoDom">
    <!-- Theme Color -->
    <meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">
    <meta name="theme-color" content="#f5f5f7" media="(prefers-color-scheme: light)">
    <link rel="stylesheet" href="index.css">
</head>
<body>
   <div id="demoWarning">
        Вы используете демо-режим. Для полного доступа войдите с учетными данными
    </div>    
    <header>
        <div class="header-inner">
            <h1>EcoDom</h1>
            <div class="header-controls">
                <button id="themeToggle">Темная тема</button>
                <button id="logoutBtn">Выйти</button>
            </div>
        </div>
    </header>
    <nav>
        <div class="nav-inner">
            <button class="tab-btn active" data-tab="dashboard">Главная</button>
            <button class="tab-btn" data-tab="history">История</button>
            <button class="tab-btn" data-tab="devices">Устройства</button>
            <button class="tab-btn" data-tab="settings">Настройки</button>
        </div>
    </nav>
    <main>
        <div id="sensor-error" class="error-message" style="display: none; color: var(--danger); padding: 10px; text-align: center;"></div>
        <div class="container">
            <div id="dashboard" class="tab-content active">
                    <h2>Текущие показания</h2>
                    <div class="sensors-grid">
                       <!-- В блоке сенсоров -->
                        <div class="sensor-card">
                            <h3>Температура</h3>    
                            <p id="temp-value">--</p>
                            <p>°C</p>
                        </div>
                        <div class="sensor-card">
                            <h3>Влажность</h3>
                            <p id="humidity-value">--</p>
                            <p>%</p>
                        </div>
                        <div class="sensor-card">
                            <h3>CO (ppm)</h3>
                            <p id="co-value">--</p>
                        </div>
                        <div class="sensor-card">
                            <h3>Солнечные панели</h3>
                            <p id="solar-value">--</p>
                            <p>В</p>
                        </div>
                        <div class="sensor-card">
                            <h3>Ветрогенератор</h3>
                            <p id="wind-value">--</p>
                            <p>В</p>
                        </div>
                        <div class="sensor-card">
                            <h3>Движение</h3>
                            <p id="motion-value">--</p>
                        </div>
                        <div class="sensor-card">
                            <h3>Батарея</h3>
                            <p id="battery-value">--</p>
                            <span id="battery-icon" class="battery-icon"></span>
                            <p>%</p>
                        </div>
                    </div>
                    <div class="device-section">
                    <h2>Камеры наблюдения</h2>
                    <div id="camerasContainer" class="cameras-container"></div>
                </div>

                  
                <div class="main-controls">
                    <h2>Управление освещением</h2>
                    <div class="control-grid" id="lightingControls">
                    <!-- Карточки будут добавляться сюда -->
                    </div>
                
                    <h2>Сценарии</h2>
                    <div class="scenario-control">
                        <label class="switch">
                            <input type="checkbox" id="awayScenario">
                            <span class="slider"></span>
                        </label>
                        <span>Режим "Уход"</span>
                    </div>
                </div>
            </div>
            
            <div id="history" class="tab-content">
                <h2>История показаний</h2>
                <div class="history-controls">
                    <select id="historySensor">
                        <option value="temp">Температура</option>
                        <option value="humidity">Влажность</option>
                        <option value="co_ppm">CO (ppm)</option>
                        <option value="solar_voltage">Солнечные панели</option>
                        <option value="wind_voltage">Ветрогенератор</option>
                        <option value="battery_level">Батарея</option>
                        <option value="motion">Движение</option>
                    </select>
                    <select id="historyRange">
                        <option value="1">За день</option>
                        <option value="7">За неделю</option>
                        <option value="30">За месяц</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="historyChart"></canvas>
            </div>
            </div>

            <div id="devices" class="tab-content">
                    <div class="tabs">
                        <div class="tab active" data-tab="devices-dashboard">Главная</div>
                        <div class="tab" data-tab="devices-list">Устройства</div>
                        <div class="tab" data-tab="add-device">Добавить устройство</div>
                    </div>
                    
                    <div id="devices-dashboard" class="tab-content active">
                        <h2>Панель управления устройствами</h2>
                        <div class="device-list" id="devicesContainer">
                            <!-- Устройства будут загружены динамически -->
                        </div>
                    </div>

                    <div id="devices-list" class="tab-content">
                        <h2>Мои устройства</h2>
                        <div class="card">
                            <table id="devicesTable">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Роль</th>
                                        <th>Статус</th>
                                        <th>Последняя активность</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Данные будут загружены динамически -->
                                     
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div id="add-device" class="tab-content">
                        <h2>Добавить устройство</h2>
                        <div class="card">
                            <div class="input-group">
                                <label for="deviceId">ID устройства:</label>
                                <input type="text" id="deviceIdInput" placeholder="Введите ID устройства">
                            </div>
                            <div class="input-group">
                                <label for="deviceRole">Тип устройства:</label>
                                <select id="deviceRole">
                                    <option value="flashlight">Свет</option>
                                    <option value="camera">Камера</option>
                                </select>
                            </div>
                            <button id="addDeviceBtn" class="form-btn">Добавить устройство</button>
                            <button onclick="window.location.href='device.html'">Перейти на страницу для устройств</button>
                            <div id="addDeviceStatus" style="margin-top: 15px;"></div>
                        </div>
                    </div>
            </div>

            <div id="settings" class="tab-content">
                <h2>Настройки</h2>
                <!-- Карточка смены пароля -->
                <div class="settings-card">
                    <h3>Сменить пароль</h3>
                    <form id="changePasswordForm">
                        <div class="input-group">
                            <label for="currentPassword">Текущий пароль</label>
                            <input type="password" id="currentPassword" required>
                        </div>
                        <div class="input-group">
                            <label for="newPassword">Новый пароль</label>
                            <input type="password" id="newPassword" required>
                        </div>
                        <div class="input-group">
                            <label for="confirmPassword">Подтвердите пароль</label>
                            <input type="password" id="confirmPassword" required>
                        </div>
                        <button type="submit" class="form-btn">Сохранить</button>
                    </form>
                </div>
                <!-- Карточка уведомлений -->
                <div class="settings-card">
                    <h3>Уведомления</h3>
                    <button id="enableFCM" class="fcm-btn">Разрешить push-уведомления</button>
                    
                    <div class="toggle-row">
                        <label class="switch">
                            <input type="checkbox" id="coNotifications" checked>
                            <span class="slider"></span>
                        </label>
                        <p>Уведомления о CO</p>
                    </div>
                    <div class="toggle-row">
                        <label class="switch">
                            <input type="checkbox" id="motionNotifications" checked>
                            <span class="slider"></span>
                        </label>
                        <p>Уведомления о движении</p>
                    </div>
                    
                    <div class="toggle-row">
                        <label class="switch">
                            <input type="checkbox" id="energyNotifications" checked>
                            <span class="slider"></span>
                        </label>
                        <p>Уведомления о питании</p>
                    </div>
                </div>
                
                <!-- Карточка статуса -->
                <div class="settings-card">
                    <h3>Статус Raspberry Pi</h3>
                    <div class="status-display">
                        <span id="statusIcon">●</span> 
                        <span id="statusText">Проверка...</span>
                    </div>
                </div>
                <div class="settings-card">
                    <a id="telegramButton" href="#">
                        <button>Перейти в Telegram-бота</button>
                    </a>
            </div>
        </div>
    </main>

    <script src="index.js"></script>
</body>
</html>
